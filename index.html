<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Telegram Auto Register/Login</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="loading" id="loading">
            <h2>üîÑ Register/Login...</h2>
            <p>Please wait...</p>
        </div>
        
        <div class="profile" id="profile" style="display: none;">
            <img id="userPhoto" src="" alt="Profile Photo">
            <h3 id="userName"></h3>
            <p id="userUsername"></p>
            <p id="userId"></p>
            <p id="userLang"></p>
            <div class="success">‚úÖ Auto register/login success!</div>
            <button onclick="openDashboard()" class="btn-primary">üìä Open Dashboard</button>
        </div>
    </div>

    <script>
        let userData = null;
        
        window.onload = () => {
            const tg = window.Telegram.WebApp;
            tg.expand();
            
            const user = tg.initDataUnsafe?.user;
            if (user) {
                userData = {
                    id: user.id,
                    first_name: user.first_name,
                    last_name: user.last_name || "",
                    username: user.username || "",
                    language_code: user.language_code || "",
                    photo_url: user.photo_url || ""
                };
                
                // Auto send back to Bot
                tg.sendData(JSON.stringify(userData));
                
                // Show profile
                document.getElementById('loading').style.display = 'none';
                document.getElementById('profile').style.display = 'block';
                
                document.getElementById('userPhoto').src = userData.photo_url || 'https://via.placeholder.com/100?text=User';
                document.getElementById('userName').textContent = `${userData.first_name} ${userData.last_name}`;
                document.getElementById('userUsername').textContent = `@${userData.username || 'N/A'}`;
                document.getElementById('userId').textContent = `User ID: ${userData.id}`;
                document.getElementById('userLang').textContent = `Language: ${userData.language_code}`;
                
                // Save to session for dashboard
                sessionStorage.setItem('userData', JSON.stringify(userData));
            } else {
                document.getElementById('loading').innerHTML = "<p>‚ùå No Telegram user info</p>";
            }
        };
        
        function openDashboard() {
            window.location.href = 'dashboard.html';
        }
    </script>
</body>
</html>
